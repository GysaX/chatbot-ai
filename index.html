<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oto Faun AI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .chat-container {
            width: 90%;
            max-width: 500px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .chat-header {
            background-color: #2196F3;
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 1.2em;
        }

        .chat-messages {
            height: 400px;
            padding: 15px;
            overflow-y: auto;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
        }

        .message.user-message {
            justify-content: flex-end;
        }

        .message-content {
            padding: 10px 15px;
            border-radius: 15px;
            max-width: 70%;
        }

        .bot-message .message-content {
            background-color: #f1f1f1;
        }

        .user-message .message-content {
            background-color: #2196F3;
            color: white;
        }

        .chat-input {
            display: flex;
            padding: 15px;
            background-color: #f9f9f9;
            border-top: 1px solid #ddd;
        }

        input[type="text"] {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 20px;
            margin-right: 10px;
            font-size: 14px;
        }

        button {
            padding: 10px 20px;
            background-color: #2196F3;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #1976D2;
        }

        .typing-indicator {
            padding: 10px 15px;
            background-color: #f1f1f1;
            border-radius: 15px;
            display: none;
            align-items: center;
            width: fit-content;
            margin-bottom: 15px;
        }

        .typing-indicator span {
            height: 8px;
            width: 8px;
            background-color: #93959a;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
            animation: bounce 1.3s linear infinite;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.15s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.3s;
            margin-right: 0;
        }

        @keyframes bounce {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-4px);
            }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            AI Chatbot
        </div>
        <div class="chat-messages" id="chatMessages">
            <div class="message bot-message">
                <div class="message-content">
                    Halo! Saya adalah chatbot AI pintar. Ada yang bisa saya bantu?
                </div>
            </div>
            <div class="typing-indicator" id="typingIndicator">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        <div class="chat-input">
            <input type="text" id="userInput" placeholder="Ketik pesan Anda...">
            <button onclick="sendMessage()">Kirim</button>
        </div>
    </div>

    <script>
        const chatMessages = document.getElementById('chatMessages');
        const userInput = document.getElementById('userInput');
        const typingIndicator = document.getElementById('typingIndicator');

        // Enhanced responses database
        const responses = {
            greetings: {
                patterns: ['halo', 'hai', 'hi', 'hello', 'hey', 'pagi', 'siang', 'sore', 'malam'],
                responses: [
                    'Halo! Apa kabar?',
                    'Hi! Ada yang bisa saya bantu?',
                    'Halo! Senang bertemu dengan Anda!',
                    'Hey! Semoga hari Anda menyenangkan!'
                ]
            },
            goodbye: {
                patterns: ['bye', 'selamat tinggal', 'sampai jumpa', 'dadah', 'good bye', 'see you'],
                responses: [
                    'Sampai jumpa! Semoga harimu menyenangkan!',
                    'Selamat tinggal! Terima kasih sudah mengobrol!',
                    'Bye! Jangan ragu untuk kembali lagi ya!'
                ]
            },
            thanks: {
                patterns: ['terima kasih', 'makasih', 'thanks', 'thank you', 'thx', 'makasih ya', 'tengkyu'],
                responses: [
                    'Sama-sama! Ada yang bisa saya bantu lagi?',
                    'Senang bisa membantu!',
                    'Terima kasih kembali!'
                ]
            },
            weather: {
                patterns: ['cuaca', 'hujan', 'panas', 'mendung', 'gerimis', 'cerah'],
                responses: [
                    'Maaf, saya tidak bisa mengecek cuaca saat ini.',
                    'Saya tidak memiliki akses ke informasi cuaca terkini.',
                    'Mungkin Anda bisa cek aplikasi cuaca untuk informasi lebih akurat.'
                ]
            },
            introduction: {
                patterns: ['siapa kamu', 'siapa namamu', 'kamu siapa', 'kenalan', 'perkenalkan'],
                responses: [
                    'Saya adalah chatbot AI yang dirancang untuk membantu Anda.',
                    'Panggil saja saya AI Assistant, saya di sini untuk membantu!',
                    'Saya asisten virtual yang siap membantu Anda 24/7.'
                ]
            },
            help: {
                patterns: ['bantuan', 'help', 'tolong', 'bisa bantu', 'bantu'],
                responses: [
                    'Tentu! Apa yang bisa saya bantu?',
                    'Saya siap membantu Anda. Apa masalahnya?',
                    'Dengan senang hati akan membantu. Apa yang Anda butuhkan?'
                ]
            },
            time: {
                patterns: ['jam berapa', 'waktu', 'tanggal', 'hari apa'],
                responses: [
                    () => `Sekarang ${new Date().toLocaleTimeString('id-ID')}`,
                    () => `Hari ini ${new Date().toLocaleDateString('id-ID')}`,
                    () => `Sekarang ${new Date().toLocaleString('id-ID')}`
                ]
            },
            mood: {
                patterns: ['apa kabar', 'bagaimana kabarmu', 'kabar', 'how are you'],
                responses: [
                    'Saya baik-baik saja! Bagaimana dengan Anda?',
                    'Sebagai AI, saya selalu dalam kondisi prima! Bagaimana dengan Anda?',
                    'Saya siap membantu! Bagaimana kabar Anda?'
                ]
            },
            jokes: {
                patterns: ['lucu', 'humor', 'joke', 'lawak'],
                responses: [
                    'Mengapa buku matematika selalu sedih? Karena terlalu banyak masalah! ðŸ˜„',
                    'Apa yang dilakukan file yang kedinginan? Mencari folder! ðŸ˜„',
                    'Kenapa komputer tidak pernah haus? Karena sudah ada Windows! ðŸ˜„'
                ]
            },
            compliments: {
                patterns: ['pintar', 'hebat', 'bagus', 'keren', 'wow', 'amazing'],
                responses: [
                    'Terima kasih! Saya senang bisa membantu!',
                    'Anda terlalu baik! Saya masih terus belajar.',
                    'Terima kasih atas pujiannya! ðŸ˜Š'
                ]
            },
            emotions: {
                patterns: ['sedih', 'senang', 'marah', 'kesal', 'bahagia', 'suka', 'cinta', 'benci'],
                responses: [
                    'Saya mengerti perasaan Anda. Mau cerita lebih lanjut?',
                    'Emosi adalah bagian dari pengalaman manusia. Bagaimana saya bisa membantu?',
                    'Saya di sini untuk mendengarkan. Mau berbagi cerita?'
                ]
            },
            default: [
                'Maaf, saya tidak mengerti. Bisa tolong jelaskan dengan cara lain?',
                'Hmm, saya masih belajar. Bisa tolong diulangi dengan kata-kata yang berbeda?',
                'Saya tidak yakin mengerti maksud Anda. Bisa dijelaskan lebih detail?'
            ]
        };

        // Context memory
        let conversationContext = {
            lastTopic: null,
            messageCount: 0,
            userMood: null
        };

        // Simple NLP functions
        const nlp = {
            tokenize: (text) => {
                return text.toLowerCase()
                    .replace(/[^\w\s]/gi, '')
                    .split(' ')
                    .filter(word => word.length > 0);
            },

            removeStopwords: (tokens) => {
                const stopwords = ['yang', 'di', 'ke', 'dari', 'pada', 'dalam', 'untuk', 'dengan', 'dan', 'atau', 'ini', 'itu', 'juga', 'sudah', 'saya', 'anda', 'dia', 'mereka', 'kita', 'akan', 'bisa', 'ada', 'tidak', 'saat', 'oleh', 'setelah', 'para', 'seperti', 'bagi'];
                return tokens.filter(token => !stopwords.includes(token));
            },

            findSimilarity: (text1, text2) => {
                const tokens1 = new Set(nlp.removeStopwords(nlp.tokenize(text1)));
                const tokens2 = new Set(nlp.removeStopwords(nlp.tokenize(text2)));
                const intersection = new Set([...tokens1].filter(x => tokens2.has(x)));
                const union = new Set([...tokens1, ...tokens2]);
                return intersection.size / union.size;
            }
        };

        function findBestResponse(message) {
            const tokens = nlp.removeStopwords(nlp.tokenize(message));
            let bestMatch = {
                category: 'default',
                similarity: 0
            };

            // Check each category for matching patterns
            for (const category in responses) {
                if (category === 'default') continue;
                
                const categoryData = responses[category];
                if (categoryData.patterns) {
                    for (const pattern of categoryData.patterns) {
                        const similarity = nlp.findSimilarity(message, pattern);
                        if (similarity > bestMatch.similarity) {
                            bestMatch = {
                                category: category,
                                similarity: similarity
                            };
                        }
                    }
                }
            }

            // Update context
            conversationContext.messageCount++;
            conversationContext.lastTopic = bestMatch.category;

            // Get response
            if (bestMatch.similarity > 0.2) {
                const responseList = responses[bestMatch.category].responses;
                const response = responseList[Math.floor(Math.random() * responseList.length)];
                return typeof response === 'function' ? response() : response;
            } else {
                return responses.default[Math.floor(Math.random() * responses.default.length)];
            }
        }

        function addMessage(message, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
            messageDiv.innerHTML = `
                <div class="message-content">
                    ${message}
                </div>
            `;
            chatMessages.insertBefore(messageDiv, typingIndicator);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showTypingIndicator() {
            typingIndicator.style.display = 'flex';
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function hideTypingIndicator() {
            typingIndicator.style.display = 'none';
        }

        async function sendMessage() {
            const message = userInput.value.trim();
            if (message === '') return;

            // Add user message
            addMessage(message, true);
            userInput.value = '';

            // Show typing indicator
            showTypingIndicator();

            // Simulate processing time
            await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 1000));

            // Hide typing indicator and add bot response
            hideTypingIndicator();
            const response = findBestResponse(message);
            addMessage(response);
        }

        // Handle Enter key
        userInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html>